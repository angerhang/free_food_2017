{"version":3,"sources":["webpack:///route-index.chunk.76f15.js","webpack:///./routes/index/style.scss","webpack:///./routes/index/index.js"],"names":["webpackJsonp","NTFd","module","exports","preview_image","scoreCircle","load","RSK7","__webpack_exports__","__webpack_require__","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","TypeError","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","defineProperty","d","Index","__WEBPACK_IMPORTED_MODULE_0_preact__","__WEBPACK_IMPORTED_MODULE_1__style__","n","__WEBPACK_IMPORTED_MODULE_1__style___default","_extends","assign","target","i","arguments","length","source","key","hasOwnProperty","_ref","class","_ref2","_ref3","_ref4","viewBox","fill","stroke-width","transform","stroke","_ref5","width","height","id","gradientUnits","x1","y1","x2","y2","stop-color","offset","_Component","props","_this","this","handleBtn","bind","handleImage","handleUpload","scaleImage","scaleCanvasWithAlgorithm","getHalfScaleCanvas","applyBilinearInterpolation","state","imgData","previewImg","score","scoreLabels","config","maxWidth","maxHeight","quality","render","_this2","style","type","onClick","accept","name","capture","onChange","ref","uploadInput","src","img","imgRef","onLoad","map","scoreLabel","a","data-name","data-percent","stroke-dashoffset","e","preventDefault","click","_this3","fileReader","FileReader","onload","loadEvent","setState","prevState","files","result","readAsDataURL","_this4","formData","FormData","append","xhr","XMLHttpRequest","open","status","console","log","response","JSON","parse","Math","round","labels","error","send","canvas","document","createElement","getContext","drawImage","toDataURL","scaledCanvas","scale","srcImgData","getImageData","destImgData","createImageData","putImageData","halfCanvas","srcCanvasData","destCanvasData","inner","f00","f10","f01","f11","x","y","un_x","un_y","j","iyv","iy0","iy1","ixv","ix0","ix1","idxD","idxS00","idxS10","idxS01","idxS11","dx","dy","r","g","b","floor","ceil","data"],"mappings":"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","file":"route-index.chunk.76f15.js","sourcesContent":["webpackJsonp([0],{\n\n/***/ \"NTFd\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\nmodule.exports = {\"preview_image\":\"preview_image__coelJ\",\"scoreCircle\":\"scoreCircle__17y1r\",\"load\":\"load__2ZbNJ\"};\n\n/***/ }),\n\n/***/ \"RSK7\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Index; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_preact__ = __webpack_require__(\"0gEq\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_preact___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_preact__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__style__ = __webpack_require__(\"NTFd\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__style___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__style__);\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\n\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\n\nvar _ref = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n    'h1',\n    { 'class': 'display-3' },\n    'Know your food!'\n);\n\nvar _ref2 = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n    'p',\n    null,\n    'Upload a picture and we will try to tell you how healthy your food is ;)'\n);\n\nvar _ref3 = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])('i', { 'class': 'fa fa-file-image-o' });\n\nvar _ref4 = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n    'svg',\n    { viewBox: '-10 -10 220 220' },\n    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n        'g',\n        { fill: 'none', 'stroke-width': '20', transform: 'translate(100,100)' },\n        __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])('path', { d: 'M 0,-100 A 100,100 0 0,1 86.6,-50', stroke: 'url(#cl1)' }),\n        __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])('path', { d: 'M 86.6,-50 A 100,100 0 0,1 86.6,50', stroke: 'url(#cl2)' }),\n        __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])('path', { d: 'M 86.6,50 A 100,100 0 0,1 0,100', stroke: 'url(#cl3)' }),\n        __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])('path', { d: 'M 0,100 A 100,100 0 0,1 -86.6,50', stroke: 'url(#cl4)' }),\n        __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])('path', { d: 'M -86.6,50 A 100,100 0 0,1 -86.6,-50', stroke: 'url(#cl5)' }),\n        __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])('path', { d: 'M -86.6,-50 A 100,100 0 0,1 0,-100', stroke: 'url(#cl6)' })\n    )\n);\n\nvar _ref5 = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n    'svg',\n    { width: '0', height: '0' },\n    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n        'defs',\n        null,\n        __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n            'linearGradient',\n            { id: 'cl1', gradientUnits: 'objectBoundingBox', x1: '0', y1: '0', x2: '1',\n                y2: '1' },\n            __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])('stop', { 'stop-color': '#490A3D' }),\n            __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])('stop', { offset: '100%', 'stop-color': '#C02942' })\n        ),\n        __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n            'linearGradient',\n            { id: 'cl2', gradientUnits: 'objectBoundingBox', x1: '0', y1: '0', x2: '0',\n                y2: '1' },\n            __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])('stop', { 'stop-color': '#C02942' }),\n            __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])('stop', { offset: '100%', 'stop-color': '#D95B43' })\n        ),\n        __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n            'linearGradient',\n            { id: 'cl3', gradientUnits: 'objectBoundingBox', x1: '1', y1: '0', x2: '0',\n                y2: '1' },\n            __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])('stop', { 'stop-color': '#D95B43' }),\n            __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])('stop', { offset: '100%', 'stop-color': '#E97F02' })\n        ),\n        __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n            'linearGradient',\n            { id: 'cl4', gradientUnits: 'objectBoundingBox', x1: '1', y1: '1', x2: '0',\n                y2: '0' },\n            __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])('stop', { 'stop-color': '#E97F02' }),\n            __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])('stop', { offset: '100%', 'stop-color': '#F8CA00' })\n        ),\n        __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n            'linearGradient',\n            { id: 'cl5', gradientUnits: 'objectBoundingBox', x1: '0', y1: '1', x2: '0',\n                y2: '0' },\n            __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])('stop', { 'stop-color': '#F8CA00' }),\n            __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])('stop', { offset: '100%', 'stop-color': '#CFF09E' })\n        ),\n        __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n            'linearGradient',\n            { id: 'cl6', gradientUnits: 'objectBoundingBox', x1: '0', y1: '1', x2: '1',\n                y2: '0' },\n            __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])('stop', { 'stop-color': '#CFF09E' }),\n            __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])('stop', { offset: '100%', 'stop-color': '#8A9B0F' })\n        )\n    )\n);\n\nvar Index = function (_Component) {\n    _inherits(Index, _Component);\n\n    function Index(props) {\n        _classCallCheck(this, Index);\n\n        var _this = _possibleConstructorReturn(this, _Component.call(this, props));\n\n        _this.handleBtn = _this.handleBtn.bind(_this);\n        _this.handleImage = _this.handleImage.bind(_this);\n        _this.handleUpload = _this.handleUpload.bind(_this);\n        _this.scaleImage = _this.scaleImage.bind(_this);\n        _this.scaleCanvasWithAlgorithm = _this.scaleCanvasWithAlgorithm.bind(_this);\n        _this.getHalfScaleCanvas = _this.getHalfScaleCanvas.bind(_this);\n        _this.applyBilinearInterpolation = _this.applyBilinearInterpolation.bind(_this);\n        _this.state = {\n            imgData: null,\n            previewImg: null,\n            score: null,\n            scoreLabels: []\n        };\n        _this.config = {\n            maxWidth: 800,\n            maxHeight: 600,\n            quality: 0.9\n        };\n        return _this;\n    }\n\n    Index.prototype.render = function render() {\n        var _this2 = this;\n\n        return __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n            'div',\n            null,\n            __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n                'div',\n                { 'class': 'jumbotron', style: 'background-color: #48B7E2; color: #ffffff;' },\n                __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n                    'div',\n                    { 'class': 'container' },\n                    _ref,\n                    _ref2,\n                    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n                        'p',\n                        null,\n                        __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n                            'button',\n                            { type: 'button', 'class': 'btn btn-primary btn-lg', onClick: this.handleBtn, style: 'background-color: #092768;' },\n                            _ref3,\n                            ' Upload Image'\n                        ),\n                        __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])('input', { type: 'file', accept: 'image/*', id: 'file', name: 'file', capture: 'camera',\n                            onChange: this.handleImage, style: 'display: none;', ref: function ref(uploadInput) {\n                                _this2.uploadInput = uploadInput;\n                            } })\n                    )\n                )\n            ),\n            __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n                'div',\n                { 'class': 'container' },\n                __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n                    'div',\n                    { 'class': 'row justify-content-center' },\n                    this.state.previewImg && __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n                        'div',\n                        { 'class': 'col-lg-4 col-md-4 col-sm-8 col-xs-8' },\n                        __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n                            'div',\n                            { 'class': 'card', style: 'width: 20rem;' },\n                            __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])('img', { 'class': 'card-img-top', src: this.state.previewImg, ref: function ref(img) {\n                                    _this2.imgRef = img;\n                                }, onLoad: this.handleUpload }),\n                            __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n                                'div',\n                                { 'class': 'card-body' },\n                                __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n                                    'ul',\n                                    null,\n                                    this.state.scoreLabels.map(function (scoreLabel) {\n                                        return __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n                                            'li',\n                                            null,\n                                            scoreLabel\n                                        );\n                                    })\n                                )\n                            )\n                        )\n                    ),\n                    this.state.score && __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n                        'div',\n                        { 'class': 'col-lg-4 col-md-4 col-sm-4 col-xs-4' },\n                        __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n                            'div',\n                            { 'class': __WEBPACK_IMPORTED_MODULE_1__style___default.a.scoreCircle },\n                            __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n                                'div',\n                                { 'data-name': 'your score', 'data-percent': this.state.score + \"% healthy\" },\n                                _ref4,\n                                __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])(\n                                    'svg',\n                                    { viewBox: '-10 -10 220 220' },\n                                    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_preact__[\"h\"])('path', {\n                                        d: 'M200,100 C200,44.771525 155.228475,0 100,0 C44.771525,0 0,44.771525 0,100 C0,155.228475 44.771525,200 100,200 C155.228475,200 200,155.228475 200,100 Z',\n                                        'stroke-dashoffset': this.state.score / 100 * 629 })\n                                )\n                            )\n                        ),\n                        _ref5\n                    )\n                )\n            )\n        );\n    };\n\n    Index.prototype.handleBtn = function handleBtn(e) {\n        e.preventDefault();\n        this.uploadInput.click();\n    };\n\n    Index.prototype.handleImage = function handleImage(e) {\n        var _this3 = this;\n\n        var fileReader = new FileReader();\n\n        fileReader.onload = function (loadEvent) {\n            _this3.setState(function (prevState) {\n                return _extends({}, prevState, {\n                    imgData: e.target.files[0],\n                    previewImg: loadEvent.target.result\n                });\n            });\n        };\n\n        fileReader.readAsDataURL(e.target.files[0]);\n    };\n\n    Index.prototype.handleUpload = function handleUpload() {\n        var _this4 = this;\n\n        var formData = new FormData();\n        //let scaledImg = this.scaleImage();\n        //let imgType = scaledImg.split(';')[0].split(':')[1];\n\n        //console.log(\"scaled: \", scaledImg);\n        //formData.append('file', scaledImg.split(',')[1]);\n        formData.append('file', this.state.imgData);\n\n        var xhr = new XMLHttpRequest();\n        xhr.open('post', '/api/food/score', true);\n\n        xhr.onload = function () {\n            if (xhr.status == 200) {\n                console.log(\"file successfully uploaded\", xhr);\n                var response = JSON.parse(xhr.response);\n                var score = Math.round(response.score);\n\n                _this4.setState(function (prevState) {\n                    return _extends({}, prevState, {\n                        score: score,\n                        scoreLabels: response.labels\n                    });\n                });\n            } else {\n                console.error(\"file upload failed :(\", xhr);\n            }\n        };\n\n        xhr.send(formData);\n    };\n\n    Index.prototype.scaleImage = function scaleImage() {\n        var img = this.imgRef;\n\n        var canvas = document.createElement('canvas');\n        canvas.width = img.width;\n        canvas.height = img.height;\n        canvas.getContext('2d').drawImage(img, 0, 0, canvas.width, canvas.height);\n\n        while (canvas.width >= 2 * this.config.maxWidth) {\n            canvas = this.getHalfScaleCanvas(canvas);\n        }\n\n        if (canvas.width > this.config.maxWidth) {\n            canvas = this.scaleCanvasWithAlgorithm(canvas);\n        }\n\n        return canvas.toDataURL('image/jpeg', this.config.quality);\n    };\n\n    Index.prototype.scaleCanvasWithAlgorithm = function scaleCanvasWithAlgorithm(canvas) {\n        var scaledCanvas = document.createElement('canvas');\n\n        var scale = this.config.maxWidth / canvas.width;\n\n        scaledCanvas.width = canvas.width * scale;\n        scaledCanvas.height = canvas.height * scale;\n\n        var srcImgData = canvas.getContext('2d').getImageData(0, 0, canvas.width, canvas.height);\n        var destImgData = scaledCanvas.getContext('2d').createImageData(scaledCanvas.width, scaledCanvas.height);\n\n        this.applyBilinearInterpolation(srcImgData, destImgData, scale);\n\n        scaledCanvas.getContext('2d').putImageData(destImgData, 0, 0);\n\n        return scaledCanvas;\n    };\n\n    Index.prototype.getHalfScaleCanvas = function getHalfScaleCanvas(canvas) {\n        var halfCanvas = document.createElement('canvas');\n        halfCanvas.width = canvas.width / 2;\n        halfCanvas.height = canvas.height / 2;\n\n        halfCanvas.getContext('2d').drawImage(canvas, 0, 0, halfCanvas.width, halfCanvas.height);\n\n        return halfCanvas;\n    };\n\n    Index.prototype.applyBilinearInterpolation = function applyBilinearInterpolation(srcCanvasData, destCanvasData, scale) {\n        function inner(f00, f10, f01, f11, x, y) {\n            var un_x = 1.0 - x;\n            var un_y = 1.0 - y;\n            return f00 * un_x * un_y + f10 * x * un_y + f01 * un_x * y + f11 * x * y;\n        }\n\n        var i = void 0,\n            j = void 0;\n        var iyv = void 0,\n            iy0 = void 0,\n            iy1 = void 0,\n            ixv = void 0,\n            ix0 = void 0,\n            ix1 = void 0;\n        var idxD = void 0,\n            idxS00 = void 0,\n            idxS10 = void 0,\n            idxS01 = void 0,\n            idxS11 = void 0;\n        var dx = void 0,\n            dy = void 0;\n        var r = void 0,\n            g = void 0,\n            b = void 0,\n            a = void 0;\n        for (i = 0; i < destCanvasData.height; ++i) {\n            iyv = i / scale;\n            iy0 = Math.floor(iyv);\n            // Math.ceil can go over bounds\n            iy1 = Math.ceil(iyv) > srcCanvasData.height - 1 ? srcCanvasData.height - 1 : Math.ceil(iyv);\n            for (j = 0; j < destCanvasData.width; ++j) {\n                ixv = j / scale;\n                ix0 = Math.floor(ixv);\n                // Math.ceil can go over bounds\n                ix1 = Math.ceil(ixv) > srcCanvasData.width - 1 ? srcCanvasData.width - 1 : Math.ceil(ixv);\n                idxD = (j + destCanvasData.width * i) * 4;\n                // matrix to vector indices\n                idxS00 = (ix0 + srcCanvasData.width * iy0) * 4;\n                idxS10 = (ix1 + srcCanvasData.width * iy0) * 4;\n                idxS01 = (ix0 + srcCanvasData.width * iy1) * 4;\n                idxS11 = (ix1 + srcCanvasData.width * iy1) * 4;\n                // overall coordinates to unit square\n                dx = ixv - ix0;\n                dy = iyv - iy0;\n                // I let the r, g, b, a on purpose for debugging\n                r = inner(srcCanvasData.data[idxS00], srcCanvasData.data[idxS10], srcCanvasData.data[idxS01], srcCanvasData.data[idxS11], dx, dy);\n                destCanvasData.data[idxD] = r;\n\n                g = inner(srcCanvasData.data[idxS00 + 1], srcCanvasData.data[idxS10 + 1], srcCanvasData.data[idxS01 + 1], srcCanvasData.data[idxS11 + 1], dx, dy);\n                destCanvasData.data[idxD + 1] = g;\n\n                b = inner(srcCanvasData.data[idxS00 + 2], srcCanvasData.data[idxS10 + 2], srcCanvasData.data[idxS01 + 2], srcCanvasData.data[idxS11 + 2], dx, dy);\n                destCanvasData.data[idxD + 2] = b;\n\n                a = inner(srcCanvasData.data[idxS00 + 3], srcCanvasData.data[idxS10 + 3], srcCanvasData.data[idxS01 + 3], srcCanvasData.data[idxS11 + 3], dx, dy);\n                destCanvasData.data[idxD + 3] = a;\n            }\n        }\n    };\n\n    return Index;\n}(__WEBPACK_IMPORTED_MODULE_0_preact__[\"Component\"]);\n\n\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// route-index.chunk.76f15.js","// removed by extract-text-webpack-plugin\nmodule.exports = {\"preview_image\":\"preview_image__coelJ\",\"scoreCircle\":\"scoreCircle__17y1r\",\"load\":\"load__2ZbNJ\"};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./routes/index/style.scss\n// module id = NTFd\n// module chunks = 0","import {h, Component} from 'preact';\nimport style from './style';\n\nexport default class Index extends Component {\n    constructor(props) {\n        super(props);\n        this.handleBtn = this.handleBtn.bind(this);\n        this.handleImage = this.handleImage.bind(this);\n        this.handleUpload = this.handleUpload.bind(this);\n        this.scaleImage = this.scaleImage.bind(this);\n        this.scaleCanvasWithAlgorithm = this.scaleCanvasWithAlgorithm.bind(this);\n        this.getHalfScaleCanvas = this.getHalfScaleCanvas.bind(this);\n        this.applyBilinearInterpolation = this.applyBilinearInterpolation.bind(this);\n        this.state = {\n            imgData: null,\n            previewImg: null,\n            score: null,\n            scoreLabels: []\n        };\n        this.config = {\n            maxWidth: 800,\n            maxHeight: 600,\n            quality: 0.9\n        }\n    }\n\n    render() {\n        return (\n            <div>\n                <div class=\"jumbotron\" style=\"background-color: #48B7E2; color: #ffffff;\">\n                    <div class=\"container\">\n                        <h1 class=\"display-3\">Know your food!</h1>\n                        <p>Upload a picture and we will try to tell you how healthy your food is ;)</p>\n                        <p>\n                            <button type=\"button\" class=\"btn btn-primary btn-lg\" onClick={this.handleBtn} style=\"background-color: #092768;\"><i class=\"fa fa-file-image-o\"></i> Upload Image</button>\n                            <input type=\"file\" accept=\"image/*\" id=\"file\" name=\"file\" capture=\"camera\"\n                                   onChange={this.handleImage} style=\"display: none;\" ref={(uploadInput) => {\n                                this.uploadInput = uploadInput;\n                            }}/>\n                        </p>\n                    </div>\n                </div>\n                <div class=\"container\">\n                    <div class=\"row justify-content-center\">\n                        {this.state.previewImg &&\n                        <div class=\"col-lg-4 col-md-4 col-sm-8 col-xs-8\">\n                            <div class=\"card\" style=\"width: 20rem;\">\n                                <img class=\"card-img-top\" src={this.state.previewImg} ref={(img) => {\n                                    this.imgRef = img;\n                                }} onLoad={this.handleUpload}/>\n                                <div class=\"card-body\">\n                                    <ul>\n                                        {this.state.scoreLabels.map((scoreLabel) =>\n                                            <li>{scoreLabel}</li>\n                                        )}\n                                    </ul>\n                                </div>\n                            </div>\n                        </div>\n                        }\n                        {this.state.score &&\n                        <div class=\"col-lg-4 col-md-4 col-sm-4 col-xs-4\">\n                            <div class={style.scoreCircle}>\n                                <div data-name=\"your score\" data-percent={this.state.score + \"% healthy\"}>\n                                    <svg viewBox=\"-10 -10 220 220\">\n                                        <g fill=\"none\" stroke-width=\"20\" transform=\"translate(100,100)\">\n                                            <path d=\"M 0,-100 A 100,100 0 0,1 86.6,-50\" stroke=\"url(#cl1)\"/>\n                                            <path d=\"M 86.6,-50 A 100,100 0 0,1 86.6,50\" stroke=\"url(#cl2)\"/>\n                                            <path d=\"M 86.6,50 A 100,100 0 0,1 0,100\" stroke=\"url(#cl3)\"/>\n                                            <path d=\"M 0,100 A 100,100 0 0,1 -86.6,50\" stroke=\"url(#cl4)\"/>\n                                            <path d=\"M -86.6,50 A 100,100 0 0,1 -86.6,-50\" stroke=\"url(#cl5)\"/>\n                                            <path d=\"M -86.6,-50 A 100,100 0 0,1 0,-100\" stroke=\"url(#cl6)\"/>\n                                        </g>\n                                    </svg>\n                                    <svg viewBox=\"-10 -10 220 220\">\n                                        <path\n                                            d=\"M200,100 C200,44.771525 155.228475,0 100,0 C44.771525,0 0,44.771525 0,100 C0,155.228475 44.771525,200 100,200 C155.228475,200 200,155.228475 200,100 Z\"\n                                            stroke-dashoffset={(this.state.score / 100) * 629}></path>\n                                    </svg>\n                                </div>\n                            </div>\n                            <svg width=\"0\" height=\"0\">\n                                <defs>\n                                    <linearGradient id=\"cl1\" gradientUnits=\"objectBoundingBox\" x1=\"0\" y1=\"0\" x2=\"1\"\n                                                    y2=\"1\">\n                                        <stop stop-color=\"#490A3D\"/>\n                                        <stop offset=\"100%\" stop-color=\"#C02942\"/>\n                                    </linearGradient>\n                                    <linearGradient id=\"cl2\" gradientUnits=\"objectBoundingBox\" x1=\"0\" y1=\"0\" x2=\"0\"\n                                                    y2=\"1\">\n                                        <stop stop-color=\"#C02942\"/>\n                                        <stop offset=\"100%\" stop-color=\"#D95B43\"/>\n                                    </linearGradient>\n                                    <linearGradient id=\"cl3\" gradientUnits=\"objectBoundingBox\" x1=\"1\" y1=\"0\" x2=\"0\"\n                                                    y2=\"1\">\n                                        <stop stop-color=\"#D95B43\"/>\n                                        <stop offset=\"100%\" stop-color=\"#E97F02\"/>\n                                    </linearGradient>\n                                    <linearGradient id=\"cl4\" gradientUnits=\"objectBoundingBox\" x1=\"1\" y1=\"1\" x2=\"0\"\n                                                    y2=\"0\">\n                                        <stop stop-color=\"#E97F02\"/>\n                                        <stop offset=\"100%\" stop-color=\"#F8CA00\"/>\n                                    </linearGradient>\n                                    <linearGradient id=\"cl5\" gradientUnits=\"objectBoundingBox\" x1=\"0\" y1=\"1\" x2=\"0\"\n                                                    y2=\"0\">\n                                        <stop stop-color=\"#F8CA00\"/>\n                                        <stop offset=\"100%\" stop-color=\"#CFF09E\"/>\n                                    </linearGradient>\n                                    <linearGradient id=\"cl6\" gradientUnits=\"objectBoundingBox\" x1=\"0\" y1=\"1\" x2=\"1\"\n                                                    y2=\"0\">\n                                        <stop stop-color=\"#CFF09E\"/>\n                                        <stop offset=\"100%\" stop-color=\"#8A9B0F\"/>\n                                    </linearGradient>\n                                </defs>\n                            </svg>\n                        </div>\n                        }\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    handleBtn(e) {\n        e.preventDefault();\n        this.uploadInput.click();\n    }\n\n    handleImage(e) {\n        let fileReader = new FileReader();\n\n        fileReader.onload = (loadEvent) => {\n            this.setState((prevState) => {\n                return {\n                    ...prevState,\n                    imgData: e.target.files[0],\n                    previewImg: loadEvent.target.result\n                };\n            });\n        };\n\n        fileReader.readAsDataURL(e.target.files[0]);\n    }\n\n    handleUpload() {\n        let formData = new FormData();\n        //let scaledImg = this.scaleImage();\n        //let imgType = scaledImg.split(';')[0].split(':')[1];\n\n        //console.log(\"scaled: \", scaledImg);\n        //formData.append('file', scaledImg.split(',')[1]);\n        formData.append('file', this.state.imgData);\n\n        let xhr = new XMLHttpRequest();\n        xhr.open('post', '/api/food/score', true);\n\n        xhr.onload = () => {\n            if (xhr.status == 200) {\n                console.log(\"file successfully uploaded\", xhr);\n                let response = JSON.parse(xhr.response);\n                let score = Math.round(response.score);\n\n                this.setState((prevState) => {\n                    return {\n                        ...prevState,\n                        score: score,\n                        scoreLabels: response.labels\n                    };\n                });\n            } else {\n                console.error(\"file upload failed :(\", xhr);\n            }\n        };\n\n        xhr.send(formData);\n    }\n\n    scaleImage() {\n        let img = this.imgRef;\n\n        let canvas = document.createElement('canvas');\n        canvas.width = img.width;\n        canvas.height = img.height;\n        canvas.getContext('2d').drawImage(img, 0, 0, canvas.width, canvas.height);\n\n        while (canvas.width >= (2 * this.config.maxWidth)) {\n            canvas = this.getHalfScaleCanvas(canvas);\n        }\n\n        if (canvas.width > this.config.maxWidth) {\n            canvas = this.scaleCanvasWithAlgorithm(canvas);\n        }\n\n        return canvas.toDataURL('image/jpeg', this.config.quality);\n    }\n\n    scaleCanvasWithAlgorithm(canvas) {\n        let scaledCanvas = document.createElement('canvas');\n\n        let scale = this.config.maxWidth / canvas.width;\n\n        scaledCanvas.width = canvas.width * scale;\n        scaledCanvas.height = canvas.height * scale;\n\n        let srcImgData = canvas.getContext('2d').getImageData(0, 0, canvas.width, canvas.height);\n        let destImgData = scaledCanvas.getContext('2d').createImageData(scaledCanvas.width, scaledCanvas.height);\n\n        this.applyBilinearInterpolation(srcImgData, destImgData, scale);\n\n        scaledCanvas.getContext('2d').putImageData(destImgData, 0, 0);\n\n        return scaledCanvas;\n    }\n\n    getHalfScaleCanvas(canvas) {\n        let halfCanvas = document.createElement('canvas');\n        halfCanvas.width = canvas.width / 2;\n        halfCanvas.height = canvas.height / 2;\n\n        halfCanvas.getContext('2d').drawImage(canvas, 0, 0, halfCanvas.width, halfCanvas.height);\n\n        return halfCanvas;\n    }\n\n    applyBilinearInterpolation(srcCanvasData, destCanvasData, scale) {\n        function inner(f00, f10, f01, f11, x, y) {\n            let un_x = 1.0 - x;\n            let un_y = 1.0 - y;\n            return (f00 * un_x * un_y + f10 * x * un_y + f01 * un_x * y + f11 * x * y);\n        }\n\n        let i, j;\n        let iyv, iy0, iy1, ixv, ix0, ix1;\n        let idxD, idxS00, idxS10, idxS01, idxS11;\n        let dx, dy;\n        let r, g, b, a;\n        for (i = 0; i < destCanvasData.height; ++i) {\n            iyv = i / scale;\n            iy0 = Math.floor(iyv);\n            // Math.ceil can go over bounds\n            iy1 = (Math.ceil(iyv) > (srcCanvasData.height - 1) ? (srcCanvasData.height - 1) : Math.ceil(iyv));\n            for (j = 0; j < destCanvasData.width; ++j) {\n                ixv = j / scale;\n                ix0 = Math.floor(ixv);\n                // Math.ceil can go over bounds\n                ix1 = (Math.ceil(ixv) > (srcCanvasData.width - 1) ? (srcCanvasData.width - 1) : Math.ceil(ixv));\n                idxD = (j + destCanvasData.width * i) * 4;\n                // matrix to vector indices\n                idxS00 = (ix0 + srcCanvasData.width * iy0) * 4;\n                idxS10 = (ix1 + srcCanvasData.width * iy0) * 4;\n                idxS01 = (ix0 + srcCanvasData.width * iy1) * 4;\n                idxS11 = (ix1 + srcCanvasData.width * iy1) * 4;\n                // overall coordinates to unit square\n                dx = ixv - ix0;\n                dy = iyv - iy0;\n                // I let the r, g, b, a on purpose for debugging\n                r = inner(srcCanvasData.data[idxS00], srcCanvasData.data[idxS10], srcCanvasData.data[idxS01], srcCanvasData.data[idxS11], dx, dy);\n                destCanvasData.data[idxD] = r;\n\n                g = inner(srcCanvasData.data[idxS00 + 1], srcCanvasData.data[idxS10 + 1], srcCanvasData.data[idxS01 + 1], srcCanvasData.data[idxS11 + 1], dx, dy);\n                destCanvasData.data[idxD + 1] = g;\n\n                b = inner(srcCanvasData.data[idxS00 + 2], srcCanvasData.data[idxS10 + 2], srcCanvasData.data[idxS01 + 2], srcCanvasData.data[idxS11 + 2], dx, dy);\n                destCanvasData.data[idxD + 2] = b;\n\n                a = inner(srcCanvasData.data[idxS00 + 3], srcCanvasData.data[idxS10 + 3], srcCanvasData.data[idxS01 + 3], srcCanvasData.data[idxS11 + 3], dx, dy);\n                destCanvasData.data[idxD + 3] = a;\n            }\n        }\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./routes/index/index.js"],"sourceRoot":""}