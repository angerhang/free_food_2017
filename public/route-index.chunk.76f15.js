webpackJsonp([0],{NTFd:function(t){t.exports={preview_image:"preview_image__coelJ",scoreCircle:"scoreCircle__17y1r",load:"load__2ZbNJ"}},RSK7:function(t,e,i){"use strict";function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"default",function(){return f});var n=i("0gEq"),r=(i.n(n),i("NTFd")),l=i.n(r),s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}return t},d=i.i(n.h)("h1",{class:"display-3"},"Know your food!"),h=i.i(n.h)("p",null,"Upload a picture and we will try to tell you how healthy your food is ;)"),c=i.i(n.h)("i",{class:"fa fa-file-image-o"}),p=i.i(n.h)("svg",{viewBox:"-10 -10 220 220"},i.i(n.h)("g",{fill:"none","stroke-width":"20",transform:"translate(100,100)"},i.i(n.h)("path",{d:"M 0,-100 A 100,100 0 0,1 86.6,-50",stroke:"url(#cl1)"}),i.i(n.h)("path",{d:"M 86.6,-50 A 100,100 0 0,1 86.6,50",stroke:"url(#cl2)"}),i.i(n.h)("path",{d:"M 86.6,50 A 100,100 0 0,1 0,100",stroke:"url(#cl3)"}),i.i(n.h)("path",{d:"M 0,100 A 100,100 0 0,1 -86.6,50",stroke:"url(#cl4)"}),i.i(n.h)("path",{d:"M -86.6,50 A 100,100 0 0,1 -86.6,-50",stroke:"url(#cl5)"}),i.i(n.h)("path",{d:"M -86.6,-50 A 100,100 0 0,1 0,-100",stroke:"url(#cl6)"}))),u=i.i(n.h)("svg",{width:"0",height:"0"},i.i(n.h)("defs",null,i.i(n.h)("linearGradient",{id:"cl1",gradientUnits:"objectBoundingBox",x1:"0",y1:"0",x2:"1",y2:"1"},i.i(n.h)("stop",{"stop-color":"#490A3D"}),i.i(n.h)("stop",{offset:"100%","stop-color":"#C02942"})),i.i(n.h)("linearGradient",{id:"cl2",gradientUnits:"objectBoundingBox",x1:"0",y1:"0",x2:"0",y2:"1"},i.i(n.h)("stop",{"stop-color":"#C02942"}),i.i(n.h)("stop",{offset:"100%","stop-color":"#D95B43"})),i.i(n.h)("linearGradient",{id:"cl3",gradientUnits:"objectBoundingBox",x1:"1",y1:"0",x2:"0",y2:"1"},i.i(n.h)("stop",{"stop-color":"#D95B43"}),i.i(n.h)("stop",{offset:"100%","stop-color":"#E97F02"})),i.i(n.h)("linearGradient",{id:"cl4",gradientUnits:"objectBoundingBox",x1:"1",y1:"1",x2:"0",y2:"0"},i.i(n.h)("stop",{"stop-color":"#E97F02"}),i.i(n.h)("stop",{offset:"100%","stop-color":"#F8CA00"})),i.i(n.h)("linearGradient",{id:"cl5",gradientUnits:"objectBoundingBox",x1:"0",y1:"1",x2:"0",y2:"0"},i.i(n.h)("stop",{"stop-color":"#F8CA00"}),i.i(n.h)("stop",{offset:"100%","stop-color":"#CFF09E"})),i.i(n.h)("linearGradient",{id:"cl6",gradientUnits:"objectBoundingBox",x1:"0",y1:"1",x2:"1",y2:"0"},i.i(n.h)("stop",{"stop-color":"#CFF09E"}),i.i(n.h)("stop",{offset:"100%","stop-color":"#8A9B0F"})))),f=function(t){function e(e){var i=o(this,t.call(this,e));return i.handleBtn=i.handleBtn.bind(i),i.handleImage=i.handleImage.bind(i),i.handleUpload=i.handleUpload.bind(i),i.scaleImage=i.scaleImage.bind(i),i.scaleCanvasWithAlgorithm=i.scaleCanvasWithAlgorithm.bind(i),i.getHalfScaleCanvas=i.getHalfScaleCanvas.bind(i),i.applyBilinearInterpolation=i.applyBilinearInterpolation.bind(i),i.state={imgData:null,previewImg:null,score:null,scoreLabels:[]},i.config={maxWidth:800,maxHeight:600,quality:.9},i}return a(e,t),e.prototype.render=function(){var t=this;return i.i(n.h)("div",null,i.i(n.h)("div",{class:"jumbotron",style:"background-color: #48B7E2; color: #ffffff;"},i.i(n.h)("div",{class:"container"},d,h,i.i(n.h)("p",null,i.i(n.h)("button",{type:"button",class:"btn btn-primary btn-lg",onClick:this.handleBtn,style:"background-color: #092768;"},c," Upload Image"),i.i(n.h)("input",{type:"file",accept:"image/*",id:"file",name:"file",capture:"camera",onChange:this.handleImage,style:"display: none;",ref:function(e){t.uploadInput=e}})))),i.i(n.h)("div",{class:"container"},i.i(n.h)("div",{class:"row justify-content-center"},this.state.previewImg&&i.i(n.h)("div",{class:"col-lg-4 col-md-4 col-sm-8 col-xs-8"},i.i(n.h)("div",{class:"card",style:"width: 20rem;"},i.i(n.h)("img",{class:"card-img-top",src:this.state.previewImg,ref:function(e){t.imgRef=e},onLoad:this.handleUpload}),i.i(n.h)("div",{class:"card-body"},i.i(n.h)("ul",null,this.state.scoreLabels.map(function(t){return i.i(n.h)("li",null,t)}))))),this.state.score&&i.i(n.h)("div",{class:"col-lg-4 col-md-4 col-sm-4 col-xs-4"},i.i(n.h)("div",{class:l.a.scoreCircle},i.i(n.h)("div",{"data-name":"your score","data-percent":this.state.score+"% healthy"},p,i.i(n.h)("svg",{viewBox:"-10 -10 220 220"},i.i(n.h)("path",{d:"M200,100 C200,44.771525 155.228475,0 100,0 C44.771525,0 0,44.771525 0,100 C0,155.228475 44.771525,200 100,200 C155.228475,200 200,155.228475 200,100 Z","stroke-dashoffset":this.state.score/100*629})))),u))))},e.prototype.handleBtn=function(t){t.preventDefault(),this.uploadInput.click()},e.prototype.handleImage=function(t){var e=this,i=new FileReader;i.onload=function(i){e.setState(function(e){return s({},e,{imgData:t.target.files[0],previewImg:i.target.result})})},i.readAsDataURL(t.target.files[0])},e.prototype.handleUpload=function(){var t=this,e=new FormData;e.append("file",this.state.imgData);var i=new XMLHttpRequest;i.open("post","/api/food/score",!0),i.onload=function(){if(200==i.status){console.log("file successfully uploaded",i);var e=JSON.parse(i.response),o=Math.round(e.score);t.setState(function(t){return s({},t,{score:o,scoreLabels:e.labels})})}else console.error("file upload failed :(",i)},i.send(e)},e.prototype.scaleImage=function(){var t=this.imgRef,e=document.createElement("canvas");for(e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0,e.width,e.height);e.width>=2*this.config.maxWidth;)e=this.getHalfScaleCanvas(e);return e.width>this.config.maxWidth&&(e=this.scaleCanvasWithAlgorithm(e)),e.toDataURL("image/jpeg",this.config.quality)},e.prototype.scaleCanvasWithAlgorithm=function(t){var e=document.createElement("canvas"),i=this.config.maxWidth/t.width;e.width=t.width*i,e.height=t.height*i;var o=t.getContext("2d").getImageData(0,0,t.width,t.height),a=e.getContext("2d").createImageData(e.width,e.height);return this.applyBilinearInterpolation(o,a,i),e.getContext("2d").putImageData(a,0,0),e},e.prototype.getHalfScaleCanvas=function(t){var e=document.createElement("canvas");return e.width=t.width/2,e.height=t.height/2,e.getContext("2d").drawImage(t,0,0,e.width,e.height),e},e.prototype.applyBilinearInterpolation=function(t,e,i){function o(t,e,i,o,a,n){var r=1-a,l=1-n;return t*r*l+e*a*l+i*r*n+o*a*n}var a=void 0,n=void 0,r=void 0,l=void 0,s=void 0,d=void 0,h=void 0,c=void 0,p=void 0,u=void 0,f=void 0,g=void 0,v=void 0,m=void 0,y=void 0,w=void 0,b=void 0,x=void 0,C=void 0;for(a=0;a<e.height;++a)for(r=a/i,l=Math.floor(r),s=Math.ceil(r)>t.height-1?t.height-1:Math.ceil(r),n=0;n<e.width;++n)d=n/i,h=Math.floor(d),c=Math.ceil(d)>t.width-1?t.width-1:Math.ceil(d),p=4*(n+e.width*a),u=4*(h+t.width*l),f=4*(c+t.width*l),g=4*(h+t.width*s),v=4*(c+t.width*s),m=d-h,y=r-l,w=o(t.data[u],t.data[f],t.data[g],t.data[v],m,y),e.data[p]=w,b=o(t.data[u+1],t.data[f+1],t.data[g+1],t.data[v+1],m,y),e.data[p+1]=b,x=o(t.data[u+2],t.data[f+2],t.data[g+2],t.data[v+2],m,y),e.data[p+2]=x,C=o(t.data[u+3],t.data[f+3],t.data[g+3],t.data[v+3],m,y),e.data[p+3]=C},e}(n.Component)}});
//# sourceMappingURL=route-index.chunk.76f15.js.map